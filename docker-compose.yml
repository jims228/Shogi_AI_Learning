services:
  api:
    build:
      context: .
    ports:
      - "8787:8787"
    volumes:
      - "./docker/engine/yaneuraou:/usr/local/bin/yaneuraou:ro"
      - "./docker/engine/eval:/usr/local/bin/eval:ro"
      - "./docker/engine/book:/usr/local/bin/book:ro"
    environment:
      PORT: "8787"
      HOST: "0.0.0.0"
      RELOAD: "0"
      USE_LLM: "0"
      LLM_PROVIDER: "gemini"
    healthcheck:
      test: ["CMD", "python", "-c", "import urllib.request as u; u.urlopen('http://localhost:8787/health').read()"]
      interval: 5s
      timeout: 3s
      retries: 30
    restart: unless-stopped

